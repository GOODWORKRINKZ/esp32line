# Геометрия и компоновка робота следующего по линии

## Исходные данные

- **Габаритные ограничения**: 150 мм (ширина) × 200 мм (длина)
- **Ширина линии**: 20 мм (2 см)
- **Количество датчиков линии**: 5 штук TCRT5000
- **Тип привода**: дифференциальный (2 ведущих колеса + 1 опорное)

## Оптимальная геометрия

### 1. Колесная база

**Рекомендуемая ширина колесной базы: 120-130 мм**

**Обоснование:**
- Минимальная стабильная база для дифференциального привода: 100 мм
- Оптимальное соотношение ширина/длина: 0.6-0.7
- Запас от максимальной ширины 150 мм: 20-30 мм для установки компонентов
- Радиус поворота: ~80-100 мм (подходит для большинства трасс)

**Выбор**: **125 мм между центрами ведущих колес**

### 2. Расположение датчиков линии

#### Схема расположения 5 датчиков:

```
        Направление движения ↑
        
   [S1]  [S2]  [S3]  [S4]  [S5]
    ●     ●     ●     ●     ●
    |← 15mm →|
    |←------ 60 мм -------→|
    
    S1 - Крайний левый
    S2 - Левый 
    S3 - Центральный
    S4 - Правый
    S5 - Крайний правый
```

**Параметры:**
- **Расстояние между соседними датчиками**: 15 мм
- **Общая ширина датчиков**: 60 мм (4 × 15 мм)
- **Расстояние от центра**: ±30 мм (крайние датчики), ±15 мм (средние)

**Обоснование:**
- При ширине линии 20 мм датчики могут надежно определить:
  - Центр линии (все 5 датчиков)
  - Отклонения влево/вправо
  - Резкие повороты (90°)
  - Т-образные перекрестки
- Расстояние 15 мм обеспечивает высокую точность позиционирования
- Общая ширина 60 мм покрывает зону ±30 мм от центра линии

### 3. Высота установки датчиков TCRT5000

**Рекомендуемая высота: 3-5 мм от поверхности**

**Технические характеристики TCRT5000:**
- Оптимальное расстояние срабатывания: 2.5-4 мм
- Максимальное расстояние обнаружения: до 15 мм
- Угол обзора: ~20°

**Практические рекомендации:**
- **3 мм** - максимальная чувствительность, но требует ровной поверхности
- **4-5 мм** - оптимальный вариант с запасом на неровности
- **Регулировка**: предусмотреть возможность регулировки высоты ±2 мм

**Важно:** Датчики должны быть установлены строго параллельно поверхности!

### 4. Расположение датчиков относительно колес

```
                    ↑ Направление
                    
    ┌─────────────────────────┐
    │   [Батарея/ESP32/L298N] │
    │                         │
    ●                         ● ← Ведущие колеса
    │                         │   (диаметр ~65-70мм)
    │    [S1][S2][S3][S4][S5]│ ← Датчики линии
    │                         │   (впереди на 30-40мм)
    │           ○             │ ← Опорное колесо
    └─────────────────────────┘
    
    Вид сверху
```

**Расстояние датчиков от оси ведущих колес: 30-40 мм (вперед)**

**Обоснование:**
- **Упреждение**: робот видит линию раньше и успевает корректировать траекторию
- **Стабильность**: оптимальное плечо для ПИД-регулирования (не слишком близко, не слишком далеко)
- **Повороты**: при 30-40 мм робот плавно проходит повороты без резких рывков

**Рекомендация**: **35 мм от оси колес до линии датчиков**

### 5. Расположение опорного колеса

**Позиция: сзади, по центру, на расстоянии 80-100 мм от оси ведущих колес**

```
    Вид сбоку:
    
    Датчики   Ведущие колеса    Опорное
       ↓            ↓              ↓
       ●────35mm────●────90mm─────○
       
    Распределение веса: 40% спереди, 60% на ведущих колесах
```

**Параметры:**
- **Расстояние от ведущих колес**: 90 мм (назад)
- **Тип**: шариковое или роликовое (360° свободного вращения)
- **Диаметр**: 15-20 мм

**Обоснование:**
- Центр тяжести смещен на ведущие колеса (лучшее сцепление)
- Достаточная база для стабильности (125 мм общая длина между датчиками и опорным колесом)
- Легкость маневрирования на поворотах

### 6. Общая компоновка (вид сверху)

```
     150 мм (макс. ширина)
    ┌─────────────────────────┐
    │                         │
    │  ┌─────────────────┐    │ ← 30 мм
    │  │   ESP32 + L298N │    │
200 │  └─────────────────┘    │
мм  │                         │
    │  ●──────125мм──────●    │ ← Колеса (диам. 65мм)
    │                         │
    │  [S1][S2][S3][S4][S5]   │ ← Датчики (35мм впереди)
    │                         │
    │          ○              │ ← Опорное колесо
    └─────────────────────────┘
    
    Размеры:
    - Ширина: ~140 мм (в пределах 150 мм)
    - Длина: ~180 мм (в пределах 200 мм)
    - Запас по габаритам: есть
```

### 7. Центр тяжести

**Оптимальное распределение веса:**
- **Батарея** (самый тяжелый компонент): над осью ведущих колес или чуть сзади
- **ESP32 + L298N**: над/за осью колес
- **Энкодеры FC-03**: на моторах
- **Датчики**: легкие, влияют минимально

**Целевое распределение:**
- 60-65% веса на ведущие колеса
- 35-40% на опорное колесо

### 8. Рекомендуемые диаметры колес

**Ведущие колеса: 65-70 мм**

**Обоснование:**
- Скорость: оптимальная для соревнований (не слишком быстро, не слишком медленно)
- Крутящий момент: хороший баланс для моторов с редуктором
- Проходимость: справляются с небольшими неровностями
- Стандарт: распространенный размер, легко найти

**Опорное колесо: 15-20 мм (шарик)**
- Минимальное сопротивление качению
- Не цепляется за неровности

## Итоговая спецификация геометрии

| Параметр | Значение | Обоснование |
|----------|----------|-------------|
| Колесная база (ширина) | 125 мм | Оптимальная стабильность и маневренность |
| Диаметр ведущих колес | 65-70 мм | Баланс скорости и момента |
| Расстояние датчиков между собой | 15 мм | Точное позиционирование на линии 20 мм |
| Ширина массива датчиков | 60 мм | Покрытие зоны ±30 мм от центра |
| Высота датчиков над землей | 4-5 мм | Оптимум для TCRT5000 |
| Датчики впереди колес | 35 мм | Упреждающее обнаружение |
| Опорное колесо сзади | 90 мм | Стабильная база |
| Общая длина | ~180 мм | В пределах 200 мм |
| Общая ширина | ~140 мм | В пределах 150 мм |

## Преимущества такой геометрии

✅ **Стабильность**: широкая колесная база предотвращает опрокидывание
✅ **Точность**: 5 датчиков с шагом 15 мм обеспечивают высокую точность
✅ **Маневренность**: дифференциальный привод позволяет разворачиваться на месте
✅ **Упреждение**: датчики впереди колес дают время на коррекцию
✅ **Универсальность**: конфигурация подходит для разных типов трасс
✅ **Соответствие регламенту**: габариты в пределах 150×200 мм

## Рекомендации по сборке

1. **Жесткое крепление датчиков**: используйте планку/печатную плату для точного позиционирования
2. **Регулировка высоты**: предусмотрите винтовую регулировку высоты датчиков
3. **Защита от вибраций**: используйте мягкие прокладки для гашения вибраций от моторов
4. **Калибровка**: после сборки обязательно откалибруйте каждый датчик на черной и белой поверхности
5. **Тестирование**: проверьте работу на прямой, плавных поворотах и резких углах 90°
